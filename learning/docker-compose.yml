services:
  hashcards:
    build: .
    container_name: hashcards
    restart: unless-stopped
    volumes:
      - hashcards_data:/data
      - ./deploy_key:/run/deploy_key:ro
    networks:
      - proxy_net

  markcards:
    build: https://github.com/masolnada/markcards.git
    container_name: markcards
    restart: unless-stopped
    environment:
      - GITHUB_REPO=${MARKCARDS_GITHUB_REPO}
      - GITHUB_TOKEN=${MARKCARDS_GITHUB_TOKEN:-}
      - GITHUB_BRANCH=${MARKCARDS_GITHUB_BRANCH:-main}
      - GITHUB_PATH=${MARKCARDS_GITHUB_PATH:-}
      - SYNC_TTL_MS=${MARKCARDS_SYNC_TTL_MS:-60000}
    volumes:
      - markcards_data:/data
    networks:
      - proxy_net

volumes:
  hashcards_data:
  markcards_data:

networks:
  proxy_net:
    external: true
